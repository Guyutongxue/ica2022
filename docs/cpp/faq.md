# C++ 相关常见问题

## 出现编译错误，但是英文我看不懂！

如果你使用 GCC（MinGW）的话，你可以尝试一下[这个小工具](../app/translation)。否则，你可能需要稍微查查词典……

有些时候，即便翻译为中文，你仍然看不懂这些错误。这时可以问问助教、同学或者老师。无论如何，下面列出了一些常见错误。

### `expected ';' before ...`

你或许少写了语句结尾的分号。

### `stray '\243' in program` `extended character ... not valid in an identifier`

- 你或许使用了中文符号。请仔细检查，并将它们替换为英文符号。
- 你或许从微信、网页等来源直接复制了代码。这些代码包含许多不可见字符，导致编译错误。此时我建议你“手抄”一遍。

## 为什么不建议使用 `<bits/stdc++.h>`？

尽管这个头文件看上去特别方便，但它有很多问题。

第一，它不是标准头文件。它只在 GCC 上提供，而 MSVC 和 LLVM 都没有——这意味着，如果你把一段包含了 `<bits/stdc++.h>` 的代码发给其他同学，他们很可能无法编译！所以为了让我们交流起来更方便，请不要用它。

第二，`<bits/stdc++.h>` 会将所有你用得上的、用不上的所有标准库设施都引入进来。你要知道，一个 `<iostream>` 就包含上千行代码，如果都引入进来就会导致整个源代码在预处理后达到数万行。这会严重拖慢编译效率，浪费时间，浪费生命。

第三，如果你还用了 `using namespace std;`，你可能会遭遇严重的命名撞车事件，请参考[这一节](#为什么不建议-using-namespace-std)。

## 我输出中文乱码了，怎么办？

这是个 Windows 上很麻烦的问题。我稍后计划写一篇比较长的文章来解释。

如果这个问题出现在 VS Code 上，那么你只需要重新用[我的工具](https://v4.vscch.tk)配置一遍，但是在最后一步勾选“调整输出编码”即可。

## 为什么没办法输入中文？

这是个 Windows 上更麻烦的问题。目前没有容易的解决办法。

## 为什么不建议 `using namespace std;`？

`std` 命名空间里的名字太多了。据不完全统计，截止至 C++23，`std` 命名空间下共有 1800 多个名字，其中不乏大量常见单词，如 `std::max` `std::begin` `std::size` 等等。

使用 `using namespace std;` 后，你就需要确保你当前程序的变量名、函数名、类型名与这 1800 多个名字不冲突（尤其是那些喜欢用 `<bits/stdc++.h>` 的同学）。名字冲突造成的错误通常是比较难发现的。

一个很经典的错误，就是定义于 `<functional>` 的 `std::bind`，与 POSIX 系统的 `bind` API 是重名的。在 `using namespace std;` 后，这两个函数就无法区分了，导致一系列难以察觉的错误。

因此我不建议你这样做。如果你觉得每次都写 `std::cin` `std::cout` `std::endl` 非常烦，可以改用 using 声明：

```cpp
// 只引入下面三个名字，不引入其它 std 下的名字
using std::cin, std::cout, std::endl;
```

## 为什么有的代码里 main 函数没有 `return`？

因为 C++ 规定，如果 main 函数结尾前没有 return 语句，则自动添加 `return 0;`。因此如果懒得写 `return 0;` 的话是可以省略掉的。

如果程序需要中途退出，我们也建议使用 `std::exit(0);`。

> 注意：C 语言在 C99 之前无此规则。
